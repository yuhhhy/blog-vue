---
title: "é¡¹ç›®å¼€å‘ä¸­é‡åˆ°çš„å‰ç«¯å­—æ•°ç»Ÿè®¡é—®é¢˜"
author: "ä¸€æ›åå¯’"
coverImage: "/images/emoji.png"
date: "2025-05-02"
tags: ["JavaScript", "å‰ç«¯"]
---
# ç»Ÿè®¡å­—æ•°

ä»Šå¤©åœ¨å¼€å‘ä¸ªäººåšå®¢æ—¶ï¼Œæœ‰ä¸€ä¸ªåšå®¢æ–‡ç« å­—æ•°ç»Ÿè®¡çš„åŠŸèƒ½éœ€è¦å®ç°

## .length

é¦–å…ˆæˆ‘æƒ³åˆ°çš„æœ€ç®€å•æ–¹æ³•å°±æ˜¯ `str.length`ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•å¹¶ä¸å¥½ï¼Œä¸ºä»€ä¹ˆï¼Ÿå› ä¸º `str.length` æ˜¯ç”¨äºç»Ÿè®¡å­—ç¬¦ä¸²é•¿åº¦çš„ï¼Œåœ¨ç»Ÿè®¡æ–‡ç« å­—æ•°æ—¶ä¼šé‡åˆ°å‡ ä¸ªé—®é¢˜ï¼š

1. ç»Ÿè®¡è‹±æ–‡å•è¯æ—¶ï¼Œä¼šæŠŠä¸€ä¸ªå•è¯è®¡ç®—æˆå¤šä¸ªå­—ç¬¦
2. ä¼šæŠŠç©ºç™½ç¬¦ç»Ÿè®¡è¿›å»ï¼Œå¹¶ä¸”è¿ç»­çš„å¤šä¸ªç©ºç™½ç¬¦ä¸ä¼šè¢«åˆå¹¶
3. ç”±äº JavaScript é‡‡ç”¨ UTF-16 ç¼–ç è§„èŒƒï¼Œä¸€äº›å­—ç¬¦å¯èƒ½ä¼šä»¥å¤šä¸ª**ç å…ƒ**è¡¨ç¤º

ï¼ˆå®é™…ä¸Šï¼Œå­—ç¬¦ä¸²çš„ length å±æ€§å°±æ˜¯åœ¨è®¿é—®è¿™ä¸ªå­—ç¬¦ä¸²æ‰€å çš„ç å…ƒï¼ŒUTF-16 ä½¿ç”¨ 16 ä½ç å…ƒï¼‰

```js
function strLength(str){
    return str.length 
} 

strLength("ä½ å¥½")  // 2 
strLength("Hello there")  // 11
strLength("   ")  // 3
strLength("\n\n\n")  //3
strLength("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦")  //11
```

## æ‹†åˆ†åŠŸèƒ½

æˆ‘ä»¬å…ˆæ¥æ‹†åˆ†è¦å®ç°çš„éœ€æ±‚ï¼Œçœ‹çœ‹å„ç±»å­—ç¬¦å¦‚ä½•ç»Ÿè®¡

### æ±‰å­—ç»Ÿè®¡

åŒ…å«æ±‰å­—å­—ç¬¦çš„å­—ç¬¦ä¸²ï¼Œé™¤éå­˜åœ¨ä¸€äº›ç½•è§æ±‰å­—ï¼Œå¦åˆ™å­—ç¬¦æ•°ç›´æ¥ä½¿ç”¨ `str.length` å°±å¯ä»¥å®Œæˆç»Ÿè®¡ã€‚å½“ç„¶ï¼Œå¦‚æœè¦å•ç‹¬è®¡ç®—æ±‰å­—å­—ç¬¦æ•°ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨æ­£åˆ™åŒ¹é…ã€‚å› ä¸ºåŸºæœ¬æ±‰å­—çš„ Unicode ç¼–ç æ˜¯ `4E00-9FA5`ï¼Œæ‰€ä»¥åŒ¹é…å•ä¸ªæ±‰å­—çš„æ­£åˆ™è¡¨è¾¾å¼å†™ä¸º `/[\u4e00-\u9fa5]/`ã€‚

```js
function matchChineseCharacter(str){  // åŒ¹é…æ‰€æœ‰æ±‰å­—ï¼Œè¿”å›æ•°ç»„
    return str.match(/[\u4e00-\u9fa5]/g)
}

const text = "ä½ å¥½ï¼Œä¸–ç•Œï¼"
strLength(text)  // 6
matchChineseCharacter(text) // ['ä½ ', 'å¥½', 'ä¸–', 'ç•Œ']
```

### è‹±æ–‡å•è¯ç»Ÿè®¡

è‹±æ–‡å•è¯çš„è®¡ç®—ç¨å¾®å¤æ‚ä¸€ç‚¹ã€‚å¦‚æœæ˜¯çº¯è‹±æ–‡æ–‡æœ¬ï¼Œä¸åŒ…å«æ±‰å­—ï¼Œé‚£ä¹ˆå»æ‰å•è¯ä¹‹é—´çš„ç©ºç™½ç¬¦ï¼Œæå–æ‰€æœ‰çš„å•è¯ç»„æˆæ•°ç»„ï¼Œé€šè¿‡ `str.split(/\s+/)` æ–¹æ³•å°±å¯ä»¥å®ç°ã€‚

```js
"hello world".split(/\s+/)  // ['hello', 'world']
```

å¦‚æœæ˜¯æ±‰å­—å’Œè‹±æ–‡å¤¹æ‚å‘¢ï¼Ÿ

å¯ä»¥é€šè¿‡å…ˆ `split` å `filter` çš„æ–¹æ³•å®ç°ã€‚

```js
function matchWords(str){
    return str.split(/\s+/).filter(word => word.match(/[a-zA-Z]/))
}

const text = "äººç”Ÿæ²¡æœ‰ Ctrl + Z ,æ¯ä¸€æ­¥éƒ½è¦ Own it"
matchWords(text)  // ['Ctrl', 'Z', 'Own', 'it']

```
ä½†æ˜¯è¿™æ ·å­æœ‰ä¸€ä¸ª**é—®é¢˜**ï¼Œé‚£å°±æ˜¯å½“è‹±æ–‡å­—ç¬¦å’Œæ ‡ç‚¹ç¬¦å·æˆ–è€…æ±‰å­—è¿åœ¨ä¸€èµ·æ—¶ï¼Œæ— æ³•è¯†åˆ«å‡ºæ¥ã€‚

```js
const textTight = "äººç”Ÿæ²¡æœ‰Ctrl+Z,æ¯ä¸€æ­¥éƒ½è¦Own it."
matchWords(textTight)  // Â ['äººç”Ÿæ²¡æœ‰Ctrl+Z,æ¯ä¸€æ­¥éƒ½è¦Own', 'it.']
```

ä¸€ä¸ªæ­£ç¡®çš„æ–¹æ³•æ˜¯ä½¿ç”¨ [Intl.Segmenter](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Intl/Segmenter)ï¼ŒJavaScript å†…ç½®çš„åˆ†è¯å™¨å¯¹è±¡ã€‚

```js
function matchWordsFinal(str){
    // åˆ›å»ºåˆ†è¯å™¨å®ä¾‹ï¼Œè®¾ç½®è¯­è¨€ä¸ºè‹±è¯­ï¼Œåˆ†å‰²ç²’åº¦ä¸ºå•è¯
    const segmenter = new Intl.Segmenter('en', { granularity: 'word' })
    // åˆ†å‰²æ–‡æœ¬å¹¶è¿‡æ»¤å‡ºå•è¯
    const segments = Array.from(segmenter.segment(str))
    const words = segments.filter(s => s.isWordLike).map(s => s.segment)
    // å†æ¬¡è¿‡æ»¤å‡ºéè‹±æ–‡å•è¯
    return words.filter(word => word.match(/^[a-zA-Z]+$/))
}

matchWordsFinal(textTight)  // ['Ctrl', 'Z', 'Own', 'it']
```

## æœ€ç»ˆå®ç°
æœ€ç»ˆï¼Œæˆ‘ä»¬å¸Œæœ›å®ç°çš„æ•ˆæœæ˜¯ï¼Œåœ¨ä¸€æ®µæ–‡å­—ä¸­ï¼Œæ—¢ç»Ÿè®¡è‹±æ–‡å•è¯ï¼Œåˆç»Ÿè®¡æ±‰å­—ã€‚ä¸€ä¸ªæ¯”è¾ƒåˆç†çš„æ–¹æ³•æ˜¯ï¼Œ `æ€»çš„å­—æ•° = æ±‰å­—æ•° + è‹±æ–‡å•è¯æ•° + æ ‡ç‚¹ç¬¦å·æ•° - ç©ºç™½ç¬¦æ•°`

å®Œæ•´ä»£ç å¦‚ä¸‹
```js
function wordCount(str){
    let res = 0
    let iTotal = 0  // æ±‰å­—æ•°
    let eTotal = 0  // å­—æ¯æ•°
    let nTotal = 0  // æ•°å­—æ•°
    let sTotal = 0  // ç©ºæ ¼æ•°
    let oTotal = 0  // å…¶ä»–å­—ç¬¦æ•°
    for (let i = 0; i < str.length; i++) {
      let c = str.charAt(i)
      if (/[\u4e00-\u9fa5]/.test(c)) {  // åŒ¹é…ä¸­æ–‡å­—ç¬¦
        iTotal++
      } else if (/[a-zA-Z]/.test(c)) {  // åŒ¹é…è‹±æ–‡å­—ç¬¦
        eTotal++
      } else if (/[0-9]/.test(c)) {  // åŒ¹é…æ•°å­—
        nTotal++
      } else if (/\s+/.test(c)) {  // åŒ¹é…ç©ºç™½ç¬¦
        sTotal++
      } else {  // åŒ¹é…æ ‡ç‚¹å’Œå…¶ä»–å­—ç¬¦
        oTotal++
      }
    }
    
    let wTotal = 0  // è‹±æ–‡å•è¯æ•°
    const segmenter = new Intl.Segmenter('en', { granularity: 'word' })
    const segments = Array.from(segmenter.segment(str))
    const words = segments.filter(s => s.isWordLike).map(s => s.segment)
    wTotal = words.filter(word => word.match(/^[a-zA-Z]+$/)).length
    
    res = str.length - eTotal + wTotal - sTotal
    return res
}

const text = "äººç”Ÿæ²¡æœ‰Ctrl+Z,æ¯ä¸€æ­¥éƒ½è¦Own it."
wordCount(text)   // 16
```

## P.S
å½“ç„¶ï¼Œä»¥ä¸Šçš„å‡½æ•°å¹¶æ²¡æœ‰å®ç°å°†ä¸€äº›ç‰¹æ®Šçš„ emoji ç¬¦å·ç»Ÿè®¡ä¸ºå•ä¸ªå­—ç¬¦çš„åŠŸèƒ½ã€‚è¿™å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨ `Intl.Segmenter` åˆ†è¯å™¨å®ç°ã€‚

```js
wordCount("ğŸ¤£")  // 2
wordCount("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦")  // 11

function emojiCount(emoji){
    const segmenter = new Intl.Segmenter("en", { granularity: "grapheme" }); 
    return [...segmenter.segment(emoji)].length
}
emojiCount("ğŸ¤£")  // 1
emojiCount("ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦")  // 1
```